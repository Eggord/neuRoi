%% Add path
addpath('..');
%% Clear variables
clear all
%% File paths
dataDir = '/home/hubo/Projects/Ca_imaging/data/';
subDir = '2018-07-16-OB3TrialLateral';
fileBaseNameArray={'BH18_32dpf_f1_OB_105um_s1_o3food_001_', ...
                   'BH18_32dpf_f1_OB_105um_s2_o3food_001_', ...
                   'BH18_32dpf_f1_OB_105um_s3_o3food_001_', ...
                   'BH18_32dpf_f1_OB_105um_s1_o1ala_001_', ...
                   'BH18_32dpf_f1_OB_105um_s2_o2ala_001_', ...
                   'BH18_32dpf_f1_OB_105um_s3_o1ala_001_', ...
                   'BH18_32dpf_f1_OB_105um_s1_o2trp_002_', ...
                   'BH18_32dpf_f1_OB_105um_s2_o1trp_001_', ...
                   'BH18_32dpf_f1_OB_105um_s3_o2trp_001_',...
                   'BH18_32dpf_f1_OB_105um_s4_spont_001_',...
                   'BH18_32dpf_f1_OB_105um_s4_spont_002_',...
                  };
filePathArray = cellfun(@(x) fullfile(dataDir,subDir,[x '.tif']),fileBaseNameArray,'UniformOutput',false);
%% Initialize model
mymodel = NrModel(filePathArray);
mycontroller = NrController(mymodel);
loadMovieOption = struct('startFrame',10,'nFrame',10);
mycontroller.setLoadMovieOption(loadMovieOption);
%% Test current trial
currentTrialInd = mymodel.currentTrialInd;
currentTrialController = mycontroller.TrialControllerArray{ind};
responseOption = struct('offset',-10,'fZeroWindow',[1 2],responseWindow,[3,4])
currentTrialController.addMap('response',responseOption);
